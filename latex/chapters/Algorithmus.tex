\chapter{Das Verfahren}\label{algo}

%\section{Accoustic single-layer integral operator}

In der Arbeit \citetitle{gasperini:hal-03209144}\cite{gasperini:hal-03209144} wird ein Verfahren zum Lösen von Integralen der Form
\begin{equation}
    \label{main_int}
    \Delta
    I_{r,\Delta}(k) = \int_{\Delta}^{}  \frac{e^{ik(\left\lVert r-r'\right\rVert + \theta \cdot r')}}{\left\lVert r-r'\right\rVert} \,dr'
\end{equation}
vorgestellt. Das Integral $\I_{r,\Delta}(k)$ ist das Integral eines Dreicks $\Delta$ mit Beobachtungspunkt $r \in \mathbb{R}^3$ für die Wellenzahl $k$. $\theta \in \mathbb{R}^3$ ist ein Richtungsvektor.
Dieses Integral wird auch als \textit{accoustic single-layer Integral-operator} bezeichnet.
Mit größer werdender Wellenzahl $k$ wird dieses Problem als im \textit{high frequency regime} liegend beschrieben und die Berechnung dieser ist mit einer hohen Laufzeit verbunden.
Die Autoren führen aus, wie das Integral sich mithilfe des Cauchysche Integralsatzes gezielt an nicht mit $k$ oszillierenden Pfaden berechnen lässt (siehe Gleichung \ref{main_cauchy_algo}).
Dies ermöglicht diese Pfade mit dem \textit{Steepest-descent}-Verfahren effizient zu berechnen.

Die Autoren von \cite{gasperini:hal-03209144} führen weiter aus, wie Pfade $h_a$ und $h_b$ bestimmt werden können und
 wie damit das Integral \ref{main_int} umgestellt werden kann \footnote{\cite[Kaptiel 1, Gleichung 4]{gasperini:hal-03209144}}:

\begin{equation}
    \label{main_cauchy_algo}
    \begin{aligned}
        I(k,y,a,b) = & \int_{h_a}^{} f(z) e^{ikg(z)} \,dz  \int_{h_b}^{} f(z) e^{ikg(z)} \,dz \\
        = & \int_{0}^{\infty} h'_a(t)f(h_a(t))e^{ikg(h_a(t))} \,dt -\int_{0}^{\infty} h'_b(t)f(h_b(t))e^{ikg(h_b(t))} \,dt 
    \end{aligned}
\end{equation}

\section{Definitionen}

Um das Verfahren nachvollziehbar darzustellen, sind einige Definitionen notwendig.
Zunächst wird in Kapitel 2 von \cite{gasperini:hal-03209144} das Integral aus Gleichung \ref{main_int} hinsichtlich eines Dreiecks $\Delta \in \mathbb{R}^3$ und eines Richtungsvektors $\theta \in \mathbb{R}^3$ betrachtet.
Das Dreieck wird als parametrisiertes Einheitsdreieck $\Delta_1$ mit folgender Abbildung definiert: $x \rightarrow Ax + b$, mit $x = (x,y)^T$, $A:= (A_l)_{1\leq l \leq 2} \in \mathbb{R}^{3\times 2}$, $A_l \in \mathbb{R}^3$ und $b \in \mathbb{R}^3$ 

Mit diesen lässt sich das Integral als
\begin{equation}
    I_{\Delta}(k) = |A_1 \times A_2 | \int_{0}^{1} \int_{0}^{1-y}  \frac{e^{ik(||Ax + b - r|| +\theta \cdot (Ax +b))}}{||Ax + b - r ||}\,dx  \,dy  =: |A_1 \times A_2 | I_{\Delta_1}^1(k)
\end{equation}\label{main_def_int}
umformulieren. Die Autoren definieren nun $P(x,y) := ||Ax+b-r||^2$ und $P(x)$, welches $P(x,y)$ für ein festes $y$ berechnet.
Dieses lässt sich mithilfe der komplexen Wurzeln $c$ und $\overline{c}$ von P und $c_0 \in [0,\infty[$ unter der Bedingung, dass $r$ nicht auf der Dreiecksfläche liegt, als 
\begin{equation}
    P(x) = c_0(x-c)(x-\overline(c))= c_0x^2+c_0|c|^2-2c_0Re(c)
\end{equation}
umformulieren (vgl. Formel 6, Kapitel 2 \cite{gasperini:hal-03209144}).
Bei festem $y$ lässt sich die Funktion $g$ als $g(x) = \sqrt(P(x)) + qx + s$ bestimmen. Dabei lassen sich $q$ und $s$ aus $qx + s := \theta \cdot(Ax+b)$ berechnen.\\

Auf dieser Grundlage lässt sich das Integral als 
\begin{equation}
    I(k,y,a,b) := \int_{a}^{b}  \frac{e^{ikg(x)}}{\sqrt(P(x))}\,dx 
\end{equation}
formulieren.\\


Die Autoren teilen dieses Problem in zwei Fälle auf; einen eindimensinalen Fall und einen zweidimensionalen Fall, der die Berechnung eines Integrals über ein Dreiecks abdeckt.


In der Arbeit \cite{gasperini:hal-03209144} wird zunächst beschrieben, wie sich das Problem auf Pfaden in der komplexen Ebene berechnen lässt, auf denen $e^{ikg(x)}$ nicht oszilliert.
Es wird gezeigt, wie sogenannte \textit{Splitting-points} berechnet werden, welche als Endpunkte für diese Pfade dienen.
Liegt einer dieser Punkte auf einem komplexen Pfad, so kann das \textit{Steepest-descent}-Verfahren nicht angewandt werden und es muss auf ein klassisches Integrationsverfahren zurückgegriffen werden, welches diese Singulariäten berechnen kann.


\section{Cauchyscher Integralsatz}

Der Cauchyscher Integralsatz ist ein Satz der Funktionentheorie. Er besagt, dass ein Kurvenintegral $\int_{\gamma}^{} f(z)\,dz $ entlang eines geschlossenen Weges $\gamma$ Null ist, wenn
$f$ auf der ganzen von $\gamma$ eingeschlossenen Fläche holomorph ist. (vgl. Kapitel 4, \cite{futheo})

Eine komplexwertige Funktion $f: D \rightarrow \mathbb{C}$ ist \textit{holomorph}, wenn $f$ in jedem Punkt von $D$ komplex differenzierbar ist.
\cite{futheo}

Für eine holomorphe Funktion $f: D \rightarrow \mathbb{C}$ mit offenem Definitionsbereich und homotopen Wegen $\gamma_0, \gamma_1: [a,b] \rightarrow D$ gilt 
\begin{equation}
    \int_{\gamma_0}^{} f(z) \,dz = \int_{\gamma_1}^{} f(z) \,dz 
\end{equation}


\section{Berechnung der \textit{Splitting-points}}

Damit das \textit{Steepest-descent}-Verfahren angewendet werden kann, muss sicher gestellt sein, dass 
die gefundenen Pfade so verbunden werden, dass keine Singularitäten auf ihnen liegen.
Die Intervalle mit Singulariäten müssen mit einem klassischen Integrationsverfahren berechnet werden.
In Kapitel 3 von \cite{gasperini:hal-03209144} wird beschrieben, wie diese Punkte berechnet werden können.
Es existieren zwei Arten von Singularitäten
\begin{enumerate}
    \item Nullstellen $c_s$ von $g$,
    \item und Anfangspunkt $c_r$ eines Weges $h_{c_r}$ der durch eine Wurzel $t_{c_r}$ der Funktion $P$ führt. 
\end{enumerate}

Da der Realteil von $g$ entlang dieses Pfades konstant ist, wegen $g(h_x(t)) = \sqrt{P(h_x(t))} + qh_x(t) + s = \sqrt{P(x)} + qx + s + it$, können die \textit{Splitting-points} mithilfe von $q$ berechnet werden.

Es wird gezeigt, dass sich mithilfe einer Fallunterscheidung 6 verschiedene Konfigurationen für die Berechnungen von $c_s$ bzw. $c_r$  unterscheiden lassen.
\begin{table}
    \centering
    \begin{tblr}{hlines,
        vlines,
        colspec={M{2cm}M{2cm}M{3cm}M{3cm}},row{2-8}={6ex}}
        \SetCell[c=2]{} Fall & & $c_s$ & $c_r$ \\
        \SetCell[c=2]{} $|q|=\infty$ & & ${c, \overline{c}}$ & $Re(c)$ \\
        \SetCell[c=2]{} $|q|=0$ & & $Re(c)$  & ${c, \overline{c}}$\\
        \SetCell[c=2]{} $|q|=\sqrt{c_0}$ & & $|c_s| = \infty$ & $|c_r| = \infty$ \\
        \SetCell[r=2]{} $|q|<\sqrt{c_0}$ & $q < 0$ & $Re(c) + K_{c_s}$ & $Re(c) + K_{c_r}$ \\
        & $q > 0$ & $Re(c) - K_{c_s}$ & $Re(c) - K_{c_r}$ \\
        \SetCell[r=2]{} $|q|>\sqrt{c_0}$ & $q < 0$ & $Re(c) + K_{c_s}$ & $Re(c) + K_{c_r}$ \\
        & $q > 0$ & $Re(c) - K_{c_s}$ & $Re(c) - K_{c_r}$ \\
    \end{tblr}
    \caption{Berechnung der \textit{Splitting-points}}
\end{table}

Dabei werden $K_{c_s}$ und $K_{c_r}$ wie folgt berechnet:
\begin{equation}
    K_{c_s} := \sqrt{Re(c)^2 - \frac{c_0Re(c)^2-q^2|c|^2}{c_0-q^2}}
\end{equation}

\begin{equation}
    K_{c_r} := \sqrt{Re(c)^2 + \frac{q^2Re(c)^2-c_0^2|c|^2}{c_0-q^2}}
\end{equation}

Da diese Punkte nicht mit dem \textit{Steepest-descent}-Verfahren berechnet werden können muss der Interval bestimmt werden, in welchem sich die \textit{Splitting-points} befinden.
Dieses Interval wird im Algorithmus durch die nächsten Nullstellen um diese Singularitäten bestimmt.

\section{Berechnung von zulässigen Pfaden}

Die Pfade, welche auf denen \textit{Steepest-descent}-Verfahren werden darf, werden in der Arbeit \textit{zulässige} (engl. \textit{admissible}) Pfade genannt.
Ein Pfad ist genau dann \textit{zulässig}, wenn sein Anfangspunkt zu $\mathbb{R} \backslash \{c_r,c_s\}$ gehört. (siehe Definition 3, Kapitel 4.1 in \cite{gasperini:hal-03209144})

Für einen Pfad $h_x$ mit Anfangspunkt $x$ wird die Funktion $K_x(t)$ als 
\begin{equation}
    K_x(t) = \sqrt{P(x)} + qx + it
\end{equation}
definiert und mithilfe dieser die beiden Funktionen $K^1_{h_x}$ und $K^2_{h_x}$ als
\begin{equation}
    \begin{aligned}
        K^1_{h_x} :=& \frac{c_0Re(c)-qK_x(t)}{c_0-q^2} \\
        K^2_{h_x} :=&\sqrt{\frac{K_x(t)^2-c_0|c|^2}{c_0-q^2}-(\frac{qK_x(t)-c_0Re(c)}{c_0-q^2})^2}
    \end{aligned}
\end{equation}
 definiert. Mithilfe dieser lassen sich wieder mit einer Fallunterscheidung (siehe Abbildung \ref{split_points}) von $q$ die Pfade berechnen.

\begin{table}[ht]
    \centering
    \begin{tblr}{hlines,
        vlines,
        colspec={M{2cm}M{2cm}M{5cm}},row{2-6}={7ex}}
        \SetCell[c=2]{} Fall & & $h_x$ \\
        \SetCell[c=2]{} $|q|=\pm \sqrt{c_0}$ & & $\dfrac{K_x(t)^2-c_o|c|^2}{\pm2(K_x(t)\sqrt{c_0}\mp c_0 Re(c))}$\\
        \SetCell[r=2]{} $|q|<\sqrt{c_0}$ & $x < c_s$ & $K^1_{h_x} - K^2_{h_x}$ \\
        & $x > c_s$ & $K^1_{h_x} + K^2_{h_x}$\\
        \SetCell[r=2]{} $|q|>\sqrt{c_0}$ & $q < 0$ & $K^1_{h_x} + K^2_{h_x}$ \\
         & $q > 0$ & $K^1_{h_x} - K^2_{h_x}$ \\
    \end{tblr}
    \caption{Berechnung der von $h_x$}\label{split_points}
\end{table}

Zur Berechnung des Verfahrens wird neben dem Pfad $h_x$ auch die Ableitung $h'_x$ benötigt.
Diese lässt sich, wie in Kapitel 4.2 von \cite{gasperini:hal-03209144} gezeigt, mithilfe von $h_x$ berechnen:

\begin{equation}
    h'_x(t) = \frac{i\sqrt{P(h_x(t))}}{c_0(h_x(t)-Re(c))+q\sqrt{P(h_x(t))}}
\end{equation}

\pagebreak

\section{Das eindimensionale Verfahren}

Der eindimenisionale Fall wird in Kapitel 5.1 von \cite{gasperini:hal-03209144} beschrieben: 

\begin{equation}
    I(k,y,a,b) = I(k,y,a,a_1) + I(k,y,a_1, b_1) + I(k,y,b_1,b)
\end{equation}

Dabei enthält das Intervall $[a_1,b_1]$ einen sogenannten \textit{Splitting-point} und das Integral $I(k,y,a_1,b_1)$ muss mit einem klassischen Verfahren berechnet werden.


Es wird gezeigt, dass das Aufteilen der Integration an den \textit{Splitting-points} und das Verbinden der Pfade auf welchen das \textit{Steepest-descent}-Verfahren angewandt wird, die Voraussetzungen für den Cauchyschen Integralsatz erfüllen.
Das erlaubt es, das Integral $I(k,y,a,b)$ wie folgt umzustellen:

\begin{equation}
    \begin{aligned}
    I(k,y,a,b) =& \int_{0}^{\infty} e^{ik(\sqrt{P(a)} + aq +s)} \frac{e^{-kt}}{\sqrt{P(h_a(t)}} h'_a(t)\,dt -\\
    & \int_{0}^{\infty} e^{ik(\sqrt{P(b)} + bq +s)} \frac{e^{-kt}}{\sqrt{P(h_b(t)}} h'_b(t)\,dt \\
    \end{aligned}
\end{equation}

\section{Das Verfahren über Dreiecksoberflächen}

In Kapitel 5.2 von \cite*{gasperini:hal-03209144} wird gezeigt, wie das Verfahren auf das ursprüngliche Ziel erweitert wird.
Dazu wird das zu berechnende Integral für ein Dreieck in $n_y$ parallele Schichten aufgeteilt, welche jeweils mit dem eindimenisionalen Verfahren berechnet werden können.
Das zweidimensionale Integral $I_{\Delta1}^1(k)$ lässt sich ohne \textit{Splitting-point} als

\begin{equation}
    I_{\Delta1}^1(k) = \int_{0}^{1} I(k,y,0,1) \,dy 
\end{equation}

beschreiben. Dieses lässt sich als

\begin{equation}
    \begin{aligned}
    I_{\Delta1}^1(k) =&  \sum_{j = 1}^{n_y}  \int_{y_{j-1}}^{y_j} \left[ e^{ik(\sqrt{P(0,y)}+q_y(1-y)+q_xy+s)} \int_{0}^{\infty} \frac{e^{-kt}}{\sqrt{P(h_0(t),y)}}h'_0(t) \,dt  \right. \\
    & \left. e^{ik(\sqrt{P(1-y,y)}+q_y(1-y)+q_xy+s)} \int_{0}^{\infty} \frac{e^{-kt}}{\sqrt{P(h_{1-y}(t),y)}}h'_{1-y}(t) \right] \,dy  
    \end{aligned}
\end{equation}
umstellen. (siehe Gleichung 19, Kapitel 5.2 \cite{gasperini:hal-03209144}) Dabei fällt auf, dass verschachtelte Integrale zu berechnen sind. Die Autoren zeigen, dass diese ausgeklammert werden können.
Dabei wird auf die Funktion 
\begin{equation}
  \Lambda_a : y \rightarrow \int_{0}^{\infty} \frac{e^{-kz}}{\sqrt{P(h_{a(y)}(t),y)}} h'_{a(y)}(t) \,dt 
\end{equation}
zurückgegriffen. Es wird gezeigt, dass sich diese mit einem vorab bestimmbaren vernachlässigbarem Fehlerterm approximieren lassen. Diese $\Lambda_a$ sind konstant für jede Schicht und lassen sich mithilfe des eindimenisionalen Verfahrens berechnen.
Mit dieser Beobachtung wird das Integral letztendlich als

\begin{equation}
    \begin{aligned}
        \hat{I}_{\Delta_1,n_y}(k) = & \sum_{j = 1}^{n_y} \left[ \Lambda_0(y_{m_j}) \int_{y_{j-1}}^{y_j}  e^{ik(\sqrt(P(0,y))+q_yy+s)}\,dy \right.\\
        & \left.  - \Lambda_{1-y_{m_j}}(y_{m_j}) \int_{y_{j-1}}^{y_j}  e^{ik(\sqrt(P(1-y,y))+q_x(1-y)+q_yy+s)}\,dy  \right] \\
    \end{aligned}
\end{equation}

umgestellt.
%Das Integral $\hat{I}$ für das Dreieck $\Delta_1$ mit der Wellenzahl $k$ wird über die Summer der Schichten $n_y$ summiert.%
%Für jede dieser Schichten werden $\Lambda_0(y_{m_j})$ und $\Lambda_{1-y_{m_j}}(y_{m_j})$ mithilfe es eindimenisionalen Verfahrens berechnet und die verbleibenden Integrale können mithilfe des \textit{Steepest-descent}-Verfahrens
%berechnet werden. 


\section{Gauss-Laguerre-Quadratur}

Die Gauss-Laguerre-Quadratur ist eine Approxmiation zur Auswertung von Integralen der Form
\begin{equation}
    \int_{0}^{\infty} f(t) e^-t  \,dt 
\end{equation}

Diese können wie folgt approximatiert werden:
\begin{equation}
    \int_{0}^{\infty} f(t) e^-t  \,dt  \approx \sum_{i = 1}^{n} w_if(x_i) 
\end{equation}

Dabei werden die Gewichte $w_i$ in dieser Arbeit Gauss-Laguerre-Gewichte und die Punkte $x$, an denen $f$ ausgewertet, wird Guass-Laguerre-Knoten genannt.

Im \textit{Steepest-descent}-Verfahren wird diese Approximation genutzt, um die Pfade $h$ in den Intervallen, welche keine Singularitäten enthalten, zu berechnen.
Dies entspricht im eindimenisionalen Fall dem Term $I(k,y,a,a_1)$ und $I(k,y,b_1,b)$.
